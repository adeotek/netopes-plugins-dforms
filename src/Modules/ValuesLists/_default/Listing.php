<?php
$ctrl_params=[
    'module'=>$this->class,
    'method'=>$this->GetCurrentMethod(),
    'persistent_state'=>TRUE,
    'target'=>'listing-content',
    'alternate_row_collor'=>TRUE,
    'scrollable'=>FALSE,
    'with_filter'=>TRUE,
    'with_pagination'=>TRUE,
    'sortby'=>['column'=>'name','direction'=>'asc'],
    'qsearch'=>'for_text',
    'ds_class'=>'Plugins\DForms\ValuesLists',
    'ds_method'=>'GetItems',
    'ds_params'=>['for_id'=>NULL,'for_state'=>NULL,'for_text'=>NULL],
    'auto_load_data'=>TRUE,
    'columns'=>[
        'actions'=>[
            'type'=>'actions',
            'visual_count'=>2,
            'actions'=>[
                [
                    'type'=>'DivButton',
                    'dright'=>'edit',
                    'command_string'=>"AjaxRequest('{$this->class}','ShowEditForm','id'|{{id}})->main-content",
                    'params'=>['tooltip'=>Translate::GetButton('edit'),'class'=>NApp::$theme->GetBtnPrimaryClass('btn-xxs'),'icon'=>'fa fa-pencil-square-o'],
                ],
                [
                    'type'=>'DivButton',
                    'dright'=>'view',
                    'command_string'=>"AjaxRequest('{$this->class}','ValuesListing','id_list'|'{{id}}','modal')->modal",
                    'params'=>['tooltip'=>Translate::GetButton('values'),'class'=>NApp::$theme->GetBtnInfoClass('btn-xxs'),'icon'=>'fa fa-list','conditions'=>[['field'=>'vcount','type'=>'>','value'=>0]]],
                ],
            ],
        ],
        'code'=>[
            'db_field'=>'ltype',
            'data_type'=>'string',
            'type'=>'value',
            'halign'=>'left',
            'label'=>Translate::GetLabel('code'),
            'sortable'=>TRUE,
            'filterable'=>TRUE,
        ],
        'name'=>[
            'db_field'=>'name',
            'data_type'=>'string',
            'type'=>'value',
            'halign'=>'left',
            'label'=>Translate::GetLabel('name'),
            'sortable'=>TRUE,
            'filterable'=>TRUE,
        ],
        'vcount'=>[
            'width'=>'120',
            'db_field'=>'vcount',
            'data_type'=>'numeric',
            'type'=>'value',
            'format'=>'integer',
            'halign'=>'center',
            'label'=>Translate::GetLabel('values_no'),
            'sortable'=>TRUE,
            'filterable'=>TRUE,
        ],
        'state'=>[
            'width'=>'80',
            'db_field'=>'state',
            'data_type'=>'numeric',
            'type'=>'checkbox',
            'label'=>Translate::GetLabel('active'),
            'sortable'=>TRUE,
            'filterable'=>TRUE,
            'filter_type'=>'combobox',
            'show_filter_cond_type'=>FALSE,
            'filter_params'=>['value_field'=>'id','display_field'=>'name','selected_value'=>NULL],
            'filter_data_source'=>[
                'ds_class'=>'_Custom\DFormsOffline',
                'ds_method'=>'GetGenericArrays',
                'ds_params'=>['type'=>'active'],
            ],
        ],
        'create_date'=>[
            'width'=>'130',
            'db_field'=>'create_date',
            'data_type'=>'datetime',
            'type'=>'value',
            'halign'=>'center',
            'format'=>'datetime',
            'label'=>Translate::GetLabel('create_date'),
            'sortable'=>TRUE,
            'filterable'=>FALSE,
        ],
        'end_actions'=>[
            'type'=>'actions',
            'visual_count'=>1,
            'actions'=>[
                [
                    'type'=>'DivButton',
                    'dright'=>'delete',
                    'command_string'=>"AjaxRequest('{$this->class}','DeleteRecord','id'|{{id}})->errors",
                    'params'=>['tooltip'=>Translate::GetButton('delete'),'class'=>NApp::$theme->GetBtnDangerClass('btn-xxs'),'icon'=>'fa fa-times','confirm_text'=>Translate::GetMessage('confirm_delete')],
                ],
            ],
        ],
    ],
];